% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/collate.R
\name{collate_soil}
\alias{collate_soil}
\title{Collate Soil Data with Metadata at Multiple Organizational Levels}
\usage{
collate_soil(con = NULL, db_path = NULL, dataset_name = NULL)
}
\arguments{
\item{con}{A DBI database connection object. If NULL, will create a connection using db_path.}

\item{db_path}{Character string specifying the path to the DuckDB database file.
Only used if con is NULL. If both are NULL, an error is raised.}

\item{dataset_name}{Optional character vector of dataset names to filter results.
If NULL (default), returns data for all available datasets with soil data.}
}
\value{
A named list with three elements:
\describe{
\item{individual}{Data frame with individual-level soil data joined with
site, treatment, plot, and plant metadata}
\item{plot}{Data frame with plot-level soil data joined with site,
treatment, and plot metadata}
\item{study}{Data frame with study-level soil data joined with site metadata}
}
}
\description{
Joins soil moisture and soil water potential data with appropriate metadata at
three organizational levels: individual plant, plot, and whole study. Returns
a named list with separate data frames for each level since soil data can be
reported at different hierarchical levels with different metadata structures.
}
\details{
Rows with all NA values for soil variables (swc_mean_shallow, swc_mean_deep,
swp_mean_shallow, swp_mean_deep) are filtered out.
}
\examples{
\dontrun{
# Using database path
soil_data <- collate_soil(db_path = "psinet.duckdb")

# Access different levels
individual_soil <- soil_data$individual
plot_soil <- soil_data$plot
study_soil <- soil_data$study

# Using existing connection
con <- DBI::dbConnect(duckdb::duckdb(), "psinet.duckdb")
soil_data <- collate_soil(con = con)
DBI::dbDisconnect(con, shutdown = TRUE)

# Filter to specific datasets
soil_data <- collate_soil(
  db_path = "psinet.duckdb",
  dataset_name = c("Smith_1", "Jones_2")
)
}
}
